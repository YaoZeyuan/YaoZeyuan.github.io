

<!DOCTYPE html>
<html lang="zh-CN" data-default-color-scheme=auto>



<head>
  <meta charset="UTF-8">
  <link rel="apple-touch-icon" sizes="76x76" href="/static/img/favicon.ico">
  <link rel="icon" href="/static/img/favicon.ico">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  
    <meta http-equiv="Content-Security-Policy" content="upgrade-insecure-requests">
  
  <meta name="theme-color" content="#2f4154">
  <meta name="author" content="姚泽源">
  <meta name="keywords" content="">
  
    <meta name="description" content="文章目标    文章假设 说明     目标人群 非 IT 专业人士, 包括不限于科研&#x2F;财务&#x2F;医生&#x2F;律师等以 windows 为办公环境, 但没有编程经验的人群   任务目标 通过且仅通过阅读文章, 完成高可用 windows 办公环境的构建   完成效果 1. 假设 D 日 12:00 电脑丢失, 且本人在国内其他城市出差, 身边无任何资料备份(但当地网络情况良好, 资料总体积不大于 300G)">
<meta property="og:type" content="article">
<meta property="og:title" content="windows 高可用办公环境搭建指南">
<meta property="og:url" content="https://www.yaozeyuan.online/2022/06/24/2022/06/[%E5%81%9C%E6%AD%A2%E5%B1%95%E7%A4%BA][%E5%B7%B2%E7%BB%8F%E6%9C%89%E7%B1%BB%E4%BC%BC%E6%96%87%E7%AB%A0]windows%E9%AB%98%E5%8F%AF%E7%94%A8%E5%8A%9E%E5%85%AC%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA%E6%8C%87%E5%8D%97/index.html">
<meta property="og:site_name" content="代号647">
<meta property="og:description" content="文章目标    文章假设 说明     目标人群 非 IT 专业人士, 包括不限于科研&#x2F;财务&#x2F;医生&#x2F;律师等以 windows 为办公环境, 但没有编程经验的人群   任务目标 通过且仅通过阅读文章, 完成高可用 windows 办公环境的构建   完成效果 1. 假设 D 日 12:00 电脑丢失, 且本人在国内其他城市出差, 身边无任何资料备份(但当地网络情况良好, 资料总体积不大于 300G)">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="http://tva1.sinaimg.cn/large/6671cfa8gy1h3jd271zfkj20x60pt0vo.jpg">
<meta property="og:image" content="http://tva1.sinaimg.cn/large/6671cfa8gy1h3jd3co4mjj20x60pt46u.jpg">
<meta property="og:image" content="http://tva1.sinaimg.cn/large/6671cfa8gy1h3jd6b9cyuj20w017gh7h.jpg">
<meta property="og:image" content="http://tva1.sinaimg.cn/large/6671cfa8gy1h3jd7tt8n5j20on0n9n0p.jpg">
<meta property="og:image" content="http://tva1.sinaimg.cn/large/6671cfa8gy1h3jdb9sh96j20op0n9jw1.jpg">
<meta property="og:image" content="http://tva1.sinaimg.cn/large/6671cfa8gy1h3jdiad9scj213r0mcn7e.jpg">
<meta property="og:image" content="http://tva1.sinaimg.cn/large/6671cfa8gy1h3jditd8aej20om0n6af9.jpg">
<meta property="og:image" content="http://tva1.sinaimg.cn/large/6671cfa8gy1h3jdk0k9zfj20op0n742z.jpg">
<meta property="og:image" content="http://tva1.sinaimg.cn/large/6671cfa8gy1h3jdo7yo2xj20oq0nbagp.jpg">
<meta property="og:image" content="http://tva1.sinaimg.cn/large/6671cfa8gy1h3jdpk0qrhj20om0n9n0z.jpg">
<meta property="og:image" content="http://tva1.sinaimg.cn/large/6671cfa8gy1h3jdtnw94qj20f60ry40e.jpg">
<meta property="og:image" content="http://tva1.sinaimg.cn/large/6671cfa8gy1h3jessj2mxj20f40rv78t.jpg">
<meta property="og:image" content="http://tva1.sinaimg.cn/large/6671cfa8gy1h3jexa7t3oj20hg0lljuk.jpg">
<meta property="og:image" content="http://tva1.sinaimg.cn/large/6671cfa8gy1h3jeyyov7sj20ol0n7q81.jpg">
<meta property="og:image" content="http://tva1.sinaimg.cn/large/6671cfa8gy1h3jezz379pj20oo0ncq9c.jpg">
<meta property="og:image" content="http://tva1.sinaimg.cn/large/6671cfa8ly1h3jmqz3loaj20ag076wg5.jpg">
<meta property="og:image" content="http://tva1.sinaimg.cn/large/6671cfa8ly1h3jmp3sxhuj20o80rh45x.jpg">
<meta property="og:image" content="http://tva1.sinaimg.cn/large/6671cfa8ly1h3jmsm1oarj20hg0h6q6d.jpg">
<meta property="og:image" content="http://tva1.sinaimg.cn/large/6671cfa8ly1h3jmu2899dj20xc0ncjxr.jpg">
<meta property="og:image" content="http://tva1.sinaimg.cn/large/6671cfa8ly1h3jmxb5mj9j20bt0hjq5e.jpg">
<meta property="og:image" content="http://tva1.sinaimg.cn/large/6671cfa8ly1h3jmzclsepj20t50l87bv.jpg">
<meta property="og:image" content="http://tva1.sinaimg.cn/large/6671cfa8ly1h3jn3ubizsj20hk0lljuw.jpg">
<meta property="og:image" content="http://tva1.sinaimg.cn/large/6671cfa8ly1h3jnj1d2ddj20t60tuk6a.jpg">
<meta property="article:published_time" content="2022-06-24T05:00:00.000Z">
<meta property="article:modified_time" content="2022-06-27T04:10:02.713Z">
<meta property="article:author" content="姚泽源">
<meta property="article:tag" content="科普">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:image" content="http://tva1.sinaimg.cn/large/6671cfa8gy1h3jd271zfkj20x60pt0vo.jpg">
  
  
  
  <title>windows 高可用办公环境搭建指南 - 代号647</title>

  <link  rel="stylesheet" href="https://lib.baomitu.com/twitter-bootstrap/4.6.1/css/bootstrap.min.css" />



  <link  rel="stylesheet" href="https://lib.baomitu.com/github-markdown-css/4.0.0/github-markdown.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/hint.css/2.7.0/hint.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.css" />



<!-- 主题依赖的图标库，不要自行修改 -->
<!-- Do not modify the link that theme dependent icons -->

<link rel="stylesheet" href="//at.alicdn.com/t/font_1749284_hj8rtnfg7um.css">



<link rel="stylesheet" href="//at.alicdn.com/t/font_1736178_lbnruvf0jn.css">


<link  rel="stylesheet" href="/css/main.css" />


  <link id="highlight-css" rel="stylesheet" href="/css/highlight.css" />
  
    <link id="highlight-css-dark" rel="stylesheet" href="/css/highlight-dark.css" />
  



  
<link rel="stylesheet" href="/static/css/customer.css">



  <script id="fluid-configs">
    var Fluid = window.Fluid || {};
    Fluid.ctx = Object.assign({}, Fluid.ctx)
    var CONFIG = {"hostname":"www.yaozeyuan.online","root":"/","version":"1.9.2","typing":{"enable":true,"typeSpeed":70,"cursorChar":"_","loop":false,"scope":[]},"anchorjs":{"enable":true,"element":"h1,h2,h3,h4,h5,h6","placement":"right","visible":"hover","icon":""},"progressbar":{"enable":true,"height_px":3,"color":"#29d","options":{"showSpinner":false,"trickleSpeed":100}},"code_language":{"enable":true,"default":"TEXT"},"copy_btn":true,"image_caption":{"enable":true},"image_zoom":{"enable":true,"img_url_replace":["",""]},"toc":{"enable":true,"placement":"right","headingSelector":"h1,h2,h3,h4,h5,h6","collapseDepth":0},"lazyload":{"enable":false,"loading_img":"/img/loading.gif","onlypost":false,"offset_factor":2},"web_analytics":{"enable":true,"follow_dnt":true,"baidu":"edcdb2b6206614cd62e6206e4c410bf5","google":null,"gtag":null,"tencent":{"sid":null,"cid":null},"woyaola":null,"cnzz":null,"leancloud":{"app_id":null,"app_key":null,"server_url":null,"path":"window.location.pathname","ignore_local":false}},"search_path":"/local-search.xml"};

    if (CONFIG.web_analytics.follow_dnt) {
      var dntVal = navigator.doNotTrack || window.doNotTrack || navigator.msDoNotTrack;
      Fluid.ctx.dnt = dntVal && (dntVal.startsWith('1') || dntVal.startsWith('yes') || dntVal.startsWith('on'));
    }
  </script>
  <script  src="/js/utils.js" ></script>
  <script  src="/js/color-schema.js" ></script>
  

  
    <!-- Baidu Analytics -->
    <script async>
      if (!Fluid.ctx.dnt) {
        var _hmt = _hmt || [];
        (function() {
          var hm = document.createElement("script");
          hm.src = "https://hm.baidu.com/hm.js?edcdb2b6206614cd62e6206e4c410bf5";
          var s = document.getElementsByTagName("script")[0];
          s.parentNode.insertBefore(hm, s);
        })();
      }
    </script>
  

  

  

  

  

  

  



  
<meta name="generator" content="Hexo 6.2.0"></head>


<body>
  

  <header>
    

<div class="header-inner" style="height: 70vh;">
  <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
  <div class="container">
    <a class="navbar-brand" href="/">
      <strong>代号647</strong>
    </a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse"
            data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto text-center">
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/">
                <i class="iconfont icon-home-fill"></i>
                首页
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/archives/">
                <i class="iconfont icon-archive-fill"></i>
                归档
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/about/">
                <i class="iconfont icon-user-fill"></i>
                关于
              </a>
            </li>
          
        
        
          <li class="nav-item" id="search-btn">
            <a class="nav-link" target="_self" href="javascript:;" data-toggle="modal" data-target="#modalSearch" aria-label="Search">
              &nbsp;<i class="iconfont icon-search"></i>&nbsp;
            </a>
          </li>
          
        
        
          <li class="nav-item" id="color-toggle-btn">
            <a class="nav-link" target="_self" href="javascript:;" aria-label="Color Toggle">&nbsp;<i
                class="iconfont icon-dark" id="color-toggle-icon"></i>&nbsp;</a>
          </li>
        
      </ul>
    </div>
  </div>
</nav>

  

<div id="banner" class="banner" parallax=true
     style="background: url('/static/img/banner/background.png') no-repeat center center; background-size: cover;">
  <div class="full-bg-img">
    <div class="mask flex-center" style="background-color: rgba(0, 0, 0, 0.3)">
      <div class="banner-text text-center fade-in-up">
        <div class="h2">
          
            <span id="subtitle" data-typed-text="windows 高可用办公环境搭建指南"></span>
          
        </div>

        
          
  <div class="mt-3">
    
    
      <span class="post-meta">
        <i class="iconfont icon-date-fill" aria-hidden="true"></i>
        <time datetime="2022-06-24 13:00" pubdate>
          2022年6月24日 下午
        </time>
      </span>
    
  </div>

  <div class="mt-1">
    
      <span class="post-meta mr-2">
        <i class="iconfont icon-chart"></i>
        
          <!-- compatible with older versions-->
          4.1k 字
        
      </span>
    

    
      <span class="post-meta mr-2">
        <i class="iconfont icon-clock-fill"></i>
        
        
        
          <!-- compatible with older versions-->
          35 分钟
        
      </span>
    

    
    
  </div>


        
      </div>

      
    </div>
  </div>
</div>

</div>

  </header>

  <main>
    
      

<div class="container-fluid nopadding-x">
  <div class="row nomargin-x">
    <div class="side-col d-none d-lg-block col-lg-2">
      

    </div>

    <div class="col-lg-8 nopadding-x-md">
      <div class="container nopadding-x-md" id="board-ctn">
        <div id="board">
          <article class="post-content mx-auto">
            <!-- SEO header -->
            <h1 style="display: none">windows 高可用办公环境搭建指南</h1>
            
            
              <div class="markdown-body">
                
                <h1>文章目标</h1>
<table>
<thead>
<tr>
<th style="text-align:left">文章假设</th>
<th style="text-align:left">说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">目标人群</td>
<td style="text-align:left">非 IT 专业人士, 包括不限于科研/财务/医生/律师等以 windows 为办公环境, 但没有编程经验的人群</td>
</tr>
<tr>
<td style="text-align:left">任务目标</td>
<td style="text-align:left">通过且仅通过阅读文章, 完成高可用 windows 办公环境的构建</td>
</tr>
<tr>
<td style="text-align:left">完成效果</td>
<td style="text-align:left">1. 假设 D 日 12:00 电脑丢失, 且本人在国内其他城市出差, 身边无任何资料备份(但当地网络情况良好, 资料总体积不大于 300G)<br/>2. D 日 14:00 完成新电脑购买后, D 日 17:00 在新电脑中完成基本数据恢复, 支持正常办公. D+1 日 8:00 完成数据整体恢复, 与旧电脑无异</td>
</tr>
<tr>
<td style="text-align:left">任务成本</td>
<td style="text-align:left">1. win10 及以上操作系统, 需打开自动更新<br/>2. 电脑本身流畅不卡顿<br/>3. Microsoft 365 订阅一份(家庭版 498 元/年, 最多支持 6 个账号同时使用, 但不建议非家庭成员间共享账号)</td>
</tr>
</tbody>
</table>
<h1>实现原理</h1>
<p><code>基本问题: 为什么数据丢失会造成损失</code></p>
<p>数据丢失损失大是因为数据本身没有备份导致. 如果数据有备份, 那么丢失后只要从备份中恢复即可.</p>
<p><code>进阶: 假设需要备份, 应该备份到哪里?</code></p>
<p>备份服务需要满足以下要求:</p>
<ol>
<li>备份方便, 最好随时备份</li>
<li>还原方便, 最好在任意时间任意地点均可还原
<ol>
<li>针对要求 2</li>
<li>排除 Dropbox 等国外服务(使用不稳定, 可能需要科学上网支持)</li>
</ol>
</li>
<li>数据安全, 私密信息不可被非本人以外的人查看, 已备份数据不可丢失.
<ol>
<li>针对要求 3</li>
<li>首先排除百度网盘(无法保障个人文件安全, 个人数据一旦被误判为非法文件会被直接删除),</li>
<li>然后排除小公司(无法保证持续经营)</li>
<li>排除自建备份服务(无法保证可靠性, 做不到多数据中心备份的话, 一次地震/火灾直接全毁)</li>
</ol>
</li>
<li>进阶: 数据还原期间, 可以逐步恢复数据. 先恢复必要数据保障日常工作生活正常使用, 非常用内容可以后台逐步恢复.
<ol>
<li>可以理解为将需要的数据文件视为占位符, 只在访问文件时才从互联网上将该文件下载下来. 需要操作系统底层支持</li>
<li>针对要求 4</li>
<li>排除 mac(有针对整个磁盘备份的时光机功能, 但恢复期间不能进入系统, 只有全部恢复完毕才可以恢复)</li>
<li>排除非 windows 官方提供的云盘(非官方云盘无法实现该要求)
<ol>
<li>如果弱化该要求, 只希望针对 office 文件进行备份, 可以选择金山云盘, 默认所有办公文件均保留在金山云盘中, 也可以使用 wps 在线版进行办公</li>
</ol>
</li>
</ol>
</li>
<li>进阶 2: 数据还原后, 希望电脑使用体验和原设备一模一样, 或者所有开启了自动同步的电脑使用体验都一样. 具体要求为:
<ol>
<li>安装应用软件后, 之前配置的应用软件设置仍在且一模一样</li>
<li>电脑桌面上的文件和原电脑保持一致, 所有希望备份的文件内容均在原有位置</li>
<li>说明: 要求 5 可以实现, 且成本非常低, 只需要遵守默认约定即可. 具体方案见<code>实施步骤</code>一节</li>
</ol>
</li>
<li>进阶 3: 恢复数据只在硬件丢失情况下执行
<ol>
<li>本地重装系统后, 只需要安装应用软件, 不必重新恢复数据</li>
</ol>
</li>
</ol>
<h1>实施步骤</h1>
<p>根据需求 1-4, 我们排除了非微软官方云盘<code>OneDrive</code>之外的所有备份方案, 又因为需要实现目标 4: 恢复数据期间不影响正常工作, 因此需要<code>win10</code>及以上平台. 因此后续流程以<code>win10</code>+<code>OneDrive</code>为底层环境进行展开. <code>OneDrive</code>本身不对外售卖, 只和<code>Office家庭版</code>一起提供, 因此假设已经购买了<code>Microsoft 365 家庭版</code>, 并有了微软账号</p>
<p>开启备份的第一步是登录账号, 以便将数据保存到云服务中</p>
<h2 id="登录系统微软账号">登录系统微软账号</h2>
<p>win10 安装成功后, 会要求登录 Microsoft 账号, 普通用户一般会选择跳过改为使用本地账号, 导致失去同步能力(登录微软账号后默认送 5GB 的免费同步空间). 考虑到买<code>Microsoft 365 家庭版</code>时一定有微软账号, 因此可以直接在系统中登录.</p>
<p>登录步骤为:</p>
<ul>
<li>进入<code>设置</code>界面, 选择<code>账户</code>
<ul>
<li><img src="http://tva1.sinaimg.cn/large/6671cfa8gy1h3jd271zfkj20x60pt0vo.jpg" alt="设置界面"></li>
</ul>
</li>
<li>在<code>账户信息</code>标签中, 点击改为 Microsoft 账户登录
<ul>
<li><img src="http://tva1.sinaimg.cn/large/6671cfa8gy1h3jd3co4mjj20x60pt46u.jpg" alt="登录"></li>
</ul>
</li>
</ul>
<h2 id="登录-Onedrive-云盘账号-并配置云盘在本地的位置">登录 Onedrive 云盘账号, 并配置云盘在本地的位置</h2>
<ul>
<li>打开开始菜单, 直接输入 OneDrive, 可以找到内置的 OneDrive 应用. 点击应用
<ul>
<li><img src="http://tva1.sinaimg.cn/large/6671cfa8gy1h3jd6b9cyuj20w017gh7h.jpg" alt="启动OneDrive"></li>
</ul>
</li>
<li>启动后会要求用户登录 OneDrive, 正常登录
<ul>
<li><img src="http://tva1.sinaimg.cn/large/6671cfa8gy1h3jd7tt8n5j20on0n9n0p.jpg" alt="登录OneDrive"></li>
</ul>
</li>
<li>登录成功后, <strong>需要配置 OneDrive 在本地的位置.</strong>
<ul>
<li>为了实现目标 6: 只有电脑丢失时才需要恢复备份, 重装系统时不需要恢复. 我们需要将 OneDrive 存储位置和系统分开. 一般选择 C 盘作为系统盘, <strong>而将 OneDrive 放在 D 盘上</strong>. 这样, 重装系统时只需要格式化 C 盘, 重装之后由于 D 盘数据本身还在, 我们只需要重新登录 OneDrive, 并指定 D 盘为存储路径, OneDrive 会自动将<code>D:/onedrive</code>目录下文件和云端文件并进行更新----由于大部分文件都没有变动过, 因此也就不需要重新下载, 我们也就可以跳过数据恢复的过程</li>
<li>登录成功
<ul>
<li><img src="http://tva1.sinaimg.cn/large/6671cfa8gy1h3jdb9sh96j20op0n9jw1.jpg" alt="登录成功"></li>
</ul>
</li>
<li>将 OneDrive 存储地址设为<code>D:/onedrive</code>
<ul>
<li><img src="http://tva1.sinaimg.cn/large/6671cfa8gy1h3jdiad9scj213r0mcn7e.jpg" alt="配置onedrive路径"></li>
</ul>
</li>
<li>提示该目录下已经有同名文件夹, 是否仍要使用----当然回答是
<ul>
<li><img src="http://tva1.sinaimg.cn/large/6671cfa8gy1h3jditd8aej20om0n6af9.jpg" alt="提示该目录下已经有同名文件夹"></li>
</ul>
</li>
<li>最终结果
<ul>
<li><img src="http://tva1.sinaimg.cn/large/6671cfa8gy1h3jdk0k9zfj20op0n742z.jpg" alt="最终结果"></li>
</ul>
</li>
</ul>
</li>
<li>登录完成后要求选择需要同步的内容
<ul>
<li>建议选择<code>全部同步</code></li>
<li>OneDrive 提供了配置项以实现要求 4: 渐进式同步, 同步期间不干扰正常工作. 后续会提到配置方法</li>
<li><img src="http://tva1.sinaimg.cn/large/6671cfa8gy1h3jdo7yo2xj20oq0nbagp.jpg" alt="选择需要同步的内容"></li>
</ul>
</li>
<li>此后是简单的功能说明, 一路下一步最后关闭窗口即可
<ul>
<li><img src="http://tva1.sinaimg.cn/large/6671cfa8gy1h3jdpk0qrhj20om0n9n0z.jpg" alt="功能说明"></li>
</ul>
</li>
</ul>
<h2 id="配置桌面-图片-文档的自动同步">配置桌面/图片/文档的自动同步</h2>
<p>登录完成后如果本地已有 OneDrive 文件夹, OneDrive 会自动在后台进行比较, 作为同步中的状态, icon 为<code>云+小圆圈</code>的样式, 让其在后台进行自动对比即可</p>
<p><img src="http://tva1.sinaimg.cn/large/6671cfa8gy1h3jdtnw94qj20f60ry40e.jpg" alt="OneDrive自动对比更改"></p>
<p>然后是重头戏 =&gt; 实现需求 5: 数据还原后, 电脑体验和原设备一模一样, 如果有多台设备, 只要登录同一账号, 不同设备间的体验也一模一样.</p>
<p>先说实现方法, 然后再介绍原理:</p>
<h3 id="多设备保持体验一致的实现方法">多设备保持体验一致的实现方法</h3>
<ul>
<li>打开 OneDrive 设置界面
<ul>
<li><img src="http://tva1.sinaimg.cn/large/6671cfa8gy1h3jessj2mxj20f40rv78t.jpg" alt="打开 OneDrive 设置界面"></li>
</ul>
</li>
<li>选择<code>备份</code>标签, 然后点击<code>管理备份</code>按钮
<ul>
<li><img src="http://tva1.sinaimg.cn/large/6671cfa8gy1h3jexa7t3oj20hg0lljuk.jpg" alt="选择标签, 然后点击按钮"></li>
</ul>
</li>
<li>勾选<code>桌面</code>/<code>文档</code>/<code>图片</code>三个文件夹, 选择开始备份
<ul>
<li><img src="http://tva1.sinaimg.cn/large/6671cfa8gy1h3jeyyov7sj20ol0n7q81.jpg" alt="配置备份目录"></li>
</ul>
</li>
<li>随后会自动执行备份
<ul>
<li><img src="http://tva1.sinaimg.cn/large/6671cfa8gy1h3jezz379pj20oo0ncq9c.jpg" alt="操作结果"></li>
</ul>
</li>
</ul>
<p>通过这个步骤, 可以将<code>桌面</code>/<code>文档</code>/<code>图片</code>中的内容进行备份. 如果满足以下两个要求, 就可以完美实现需求 5: <code>数据还原后, 希望电脑使用体验和原设备一模一样, 或者所有开启了自动同步的电脑使用体验都一样</code></p>
<ol>
<li>如果文件需要备份, 则统一放在<code>文档</code>下的一个目录中(例如可以起名叫<code>同步盘</code>)</li>
<li>安装任何需要同步的应用程序时, 不选择安装位置, 而是一路下一步, 使用默认配置(微信/企业微信/QQ 需要额外操作, 后边会说明)</li>
</ol>
<p>解释一下原理:</p>
<h4 id="跨设备文件同步原理-2">跨设备文件同步原理</h4>
<p>对于所有需要同步的文件统一放在<code>文档</code>目录下, 这个原因比较简单: 因为<code>文档</code>文件夹会被 OneDrive 自动同步, 因此文件夹内的<code>需同步文件</code>自然也会被同步.</p>
<p>又因为各个设备上 OneDrive 本地文件夹所在的路径一样(都是<code>D:/</code>盘下的<code>onedrive</code>文件夹), 所以不管哪台电脑, 都可以按相同路径找到对应文件</p>
<h4 id="跨设备应用程序同步原理-2">跨设备应用程序同步原理</h4>
<p>应用程序分为两个部分:</p>
<ol>
<li><code>程序本体</code></li>
<li>应用程序的<code>配置文件</code>/<code>数据库文件</code></li>
</ol>
<p>我们对应用程序所做的任何修改, 都会被储存到<code>配置文件</code>/<code>数据库文件</code>中. 只要配置文件相同, 应用程序的行为也一定相同.</p>
<p>而一路<code>下一步</code>安装时, 由于我们走的是默认安装流程, 所以<code>配置文件</code>/<code>数据库文件</code>也会被放在默认的位置下, 也就是<code>文档</code>文件夹中</p>
<p>而我们又已经配置了<code>文档</code>文件夹的自动同步功能</p>
<p>所以, 即使重装了系统, 我们也只要重新安装一遍应用程序, 把<code>程序本体</code>补上, 程序启动后发现<code>文档</code>下已经有了(之前备份好了的)<code>配置文件</code>, 会直接基于(根据备份还原出的)<code>配置文件</code>启动, 其表现自然也和备份时一样.</p>
<h4 id="跨设备同步应用程序配置时需要注意的事-2">跨设备同步应用程序配置时需要注意的事</h4>
<p>这个太重要以至于需要单拉出来说一下:</p>
<p>跨设备同步应用程序配置对于绝大多数应用都可以使用, 但个别应用例外:</p>
<ol>
<li>配置/数据库文件内容巨大且经常变的应用
<ol>
<li>例如: 微信/企业微信/QQ. 他们会把聊天图片和聊天中接收的文件也放在<code>文档</code>文件夹下, 快速耗尽 OneDrive 容量. 因此需要将他们从 OneDrive 中移出来.</li>
<li>我的解决方案是:
<ol>
<li>在<code>D盘</code>下, 创建<code>tencent_wechat</code>文件夹, 里边分别创建<code>wechat</code>/<code>wework</code>/<code>qq</code>三个文件夹, 专门放他们三个的聊天记录.</li>
<li>微信配置方法
<ol>
<li><img src="http://tva1.sinaimg.cn/large/6671cfa8ly1h3jmqz3loaj20ag076wg5.jpg" alt="微信配置方法-1"></li>
<li><img src="http://tva1.sinaimg.cn/large/6671cfa8ly1h3jmp3sxhuj20o80rh45x.jpg" alt="微信配置方法-2"></li>
</ol>
</li>
<li>企业微信配置方法
<ol>
<li><img src="http://tva1.sinaimg.cn/large/6671cfa8ly1h3jmsm1oarj20hg0h6q6d.jpg" alt="企业微信配置方法-1"></li>
<li><img src="http://tva1.sinaimg.cn/large/6671cfa8ly1h3jmu2899dj20xc0ncjxr.jpg" alt="企业微信配置方法-2"></li>
</ol>
</li>
<li>QQ 配置方法
<ol>
<li><img src="http://tva1.sinaimg.cn/large/6671cfa8ly1h3jmxb5mj9j20bt0hjq5e.jpg" alt="QQ配置方法-1"></li>
<li><img src="http://tva1.sinaimg.cn/large/6671cfa8ly1h3jmzclsepj20t50l87bv.jpg" alt="QQ配置方法-2"></li>
</ol>
</li>
</ol>
</li>
</ol>
</li>
<li>会产生大量零散文件, 且这些文件经常变动且都有用处的应用
<ol>
<li>这条针对的是程序员, 不能将 git 仓库(.git 目录中有大量小文件)/前端项目(有 node_modules 目录)放在自动同步中, 否则漏了两个, 或者删除文件后 OneDrive 主动帮你还原回来导致代码启动不了, 都很麻烦</li>
</ol>
</li>
</ol>
<h3 id="渐进式数据还原-数据还原期间保持电脑可用的方案">渐进式数据还原----数据还原期间保持电脑可用的方案</h3>
<p>目前除 4 以外的所有要求均已实现, 只剩下这一个需求, 怎么处理呢? 答案是勾选 OneDrive 上的一个选型</p>
<p><img src="http://tva1.sinaimg.cn/large/6671cfa8ly1h3jn3ubizsj20hk0lljuw.jpg" alt="按需同步"></p>
<p>当勾选按需同步时, OneDrive 只会创建文件占位符, 不会真实下载文件. 该功能主要在第一次恢复数据时使用, 或者当硬盘容量不够时使用(通过不同步照片/视频的方式节约硬盘空间). 勾选该选项后, 默认不会下载源文件, 只有当用户真实访问文件时才会去下载.</p>
<p>建议是紧急情况下再使用, 正常来说, 300G 的内容, 一晚上也足够全同步下来了.</p>
<h1>其他</h1>
<p>除了系统文件, 还有一些其他的数据需要同步. 我使用的是下边的方案, 仅供参考:</p>
<ol>
<li>浏览器使用 chrome, 并登录 Google 账号. 这样所有的<code>收藏夹</code>/<code>访问记录</code>/<code>浏览器插件</code>都会被保存在谷歌服务器上. 可以自动同步
<ol>
<li>对于普通用户而言, 需要同步浏览器数据可以使用两种方案
<ol>
<li>win10 之后系统内置了 Edge 浏览器, 可以视为国内可用的 chrome(是微软团队基于 chrome 开发出的浏览器产品), 登录微软账号后也可以同步<code>收藏夹</code>/<code>访问记录</code>/<code>浏览器插件</code>内容</li>
<li>使用国产浏览器, 例如 360 浏览器, 登录账号后也可以进行同步</li>
</ol>
</li>
</ol>
</li>
<li><strong>系统安全</strong>
<ol>
<li>虽然可以信任微软本身不会查阅我们的数据, 但把数据全同步在 OneDrive 上也就意味着一旦微软账号被盗, 盗号者本身也能拿到云盘中所有的文件. 所以必须保护好微软账号.</li>
<li>我的做法是:
<ol>
<li>微软账号单设一个密码, 只在这一个地方使用, 其他地方<strong>绝对不用相同或类似密码</strong></li>
<li>其他密码统一用密码管理软件(keepass)生成, 使用 OneDrive 同步密码数据库文件. 密码数据库也有一个独立的密码, 同样也是只在这一个地方使用, 其他地方<strong>绝对不用相同或类似密码</strong></li>
<li>这样, 由于微软账号安全, 所以文件安全</li>
<li>由于其他软件密码由密码数据库生成, 又因为文件安全&amp;管理密码所以密码文件本身不会外泄, 所以其他软件也安全.</li>
</ol>
</li>
</ol>
</li>
<li>版本控制
<ol>
<li>对于任意备份的文件, OneDrive 默认保留 30 天内的所有版本修改. 可以还原到其中的任意一个版本. 这个时间范围足够日常使用了
<ol>
<li>示例:
<ol>
<li><img src="http://tva1.sinaimg.cn/large/6671cfa8ly1h3jnj1d2ddj20t60tuk6a.jpg" alt="版本历史示例"></li>
</ol>
</li>
</ol>
</li>
</ol>
</li>
</ol>
<p>预祝各位永远用不到恢复功能~</p>
<style>
  /* 图片太大了, 统一缩小一半 */
  a[itemscope] img {
    width:50%;
  }
</style>

                
              </div>
            
            <hr/>
            <div>
              <div class="post-metas my-3">
  
  
    <div class="post-meta">
      <i class="iconfont icon-tags"></i>
      
        <a href="/tags/%E7%A7%91%E6%99%AE/">#科普</a>
      
    </div>
  
</div>


              
  

  <div class="license-box my-3">
    <div class="license-title">
      <div>windows 高可用办公环境搭建指南</div>
      <div>https://www.yaozeyuan.online/2022/06/24/2022/06/[停止展示][已经有类似文章]windows高可用办公环境搭建指南/</div>
    </div>
    <div class="license-meta">
      
        <div class="license-meta-item">
          <div>作者</div>
          <div>姚泽源</div>
        </div>
      
      
        <div class="license-meta-item license-meta-date">
          <div>发布于</div>
          <div>2022年6月24日</div>
        </div>
      
      
      <div class="license-meta-item">
        <div>许可协议</div>
        <div>
          
            
            
              <a target="_blank" href="https://creativecommons.org/licenses/by/4.0/">
              <span class="hint--top hint--rounded" aria-label="BY - 署名">
                <i class="iconfont icon-by"></i>
              </span>
              </a>
            
          
        </div>
      </div>
    </div>
    <div class="license-icon iconfont"></div>
  </div>



              
                <div class="post-prevnext my-3">
                  <article class="post-prev col-6">
                    
                    
                      <a href="/2022/06/25/2022/06/30%E5%88%86%E9%92%9F%E6%90%9E%E5%AE%9A%E4%B8%AA%E4%BA%BA%E6%95%B0%E6%8D%AE%E5%A4%87%E4%BB%BD/" title="30分钟搞定个人数据备份">
                        <i class="iconfont icon-arrowleft"></i>
                        <span class="hidden-mobile">30分钟搞定个人数据备份</span>
                        <span class="visible-mobile">上一篇</span>
                      </a>
                    
                  </article>
                  <article class="post-next col-6">
                    
                    
                      <a href="/2022/06/13/2022/06/%E5%8F%AF%E9%80%89%E5%85%AC%E5%8F%B8%E8%81%8C%E4%BD%8D%E8%A1%A8/" title="可选公司职位表">
                        <span class="hidden-mobile">可选公司职位表</span>
                        <span class="visible-mobile">下一篇</span>
                        <i class="iconfont icon-arrowright"></i>
                      </a>
                    
                  </article>
                </div>
              
            </div>

            
  <article id="comments">
    
  <div id="gitalk-container"></div>
  <script type="text/javascript">
    Fluid.utils.loadComments('#gitalk-container', function() {
      Fluid.utils.createCssLink('/css/gitalk.css')
      Fluid.utils.createScript('https://lib.baomitu.com/gitalk/1.7.2/gitalk.min.js', function() {
        var options = Object.assign(
          {"clientID":"cb51e467ab7545f311d9","clientSecret":"8712d8263ec17f168dc461ec5ba948d71ea9fb06","repo":"YaoZeyuan.github.io","owner":"YaoZeyuan","admin":["YaoZeyuan"],"language":"zh-CN","labels":["Gitalk"],"perPage":10,"pagerDirection":"last","distractionFreeMode":false,"createIssueManually":true,"proxy":"https://cors-anywhere.azm.workers.dev/https://github.com/login/oauth/access_token","id":"pageId"},
          {
            id: '33640a5b4f3e6d25785c86dfc5f60be0'
          }
        )
        var gitalk = new Gitalk(options);
        gitalk.render('gitalk-container');
      });
    });
  </script>
  <noscript>Please enable JavaScript to view the comments</noscript>


  </article>


          </article>
        </div>
      </div>
    </div>

    <div class="side-col d-none d-lg-block col-lg-2">
      
  <aside class="sidebar" style="margin-left: -1rem">
    <div id="toc">
  <p class="toc-header"><i class="iconfont icon-list"></i>&nbsp;目录</p>
  <div class="toc-body" id="toc-body"></div>
</div>



  </aside>


    </div>
  </div>
</div>





  



  



  



  



  







    

    
      <a id="scroll-top-button" aria-label="TOP" href="#" role="button">
        <i class="iconfont icon-arrowup" aria-hidden="true"></i>
      </a>
    

    
      <div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel"
     aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">搜索</h4>
        <button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body mx-3">
        <div class="md-form mb-5">
          <input type="text" id="local-search-input" class="form-control validate">
          <label data-error="x" data-success="v" for="local-search-input">关键词</label>
        </div>
        <div class="list-group" id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>

    

    
  </main>

  <footer>
    <div class="footer-inner">
  
    <div class="footer-content">
       <a href="https://hexo.io" target="_blank" rel="nofollow noopener"><span>Hexo</span></a> <i class="iconfont icon-love"></i> <a href="https://github.com/fluid-dev/hexo-theme-fluid" target="_blank" rel="nofollow noopener"><span>Fluid</span></a> 
    </div>
  
  
  
  
</div>

  </footer>

  <!-- Scripts -->
  
  <script  src="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.js" ></script>
  <link  rel="stylesheet" href="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.css" />

  <script>
    NProgress.configure({"showSpinner":false,"trickleSpeed":100})
    NProgress.start()
    window.addEventListener('load', function() {
      NProgress.done();
    })
  </script>


<script  src="https://lib.baomitu.com/jquery/3.6.0/jquery.min.js" ></script>
<script  src="https://lib.baomitu.com/twitter-bootstrap/4.6.1/js/bootstrap.min.js" ></script>
<script  src="/js/events.js" ></script>
<script  src="/js/plugins.js" ></script>


  <script  src="https://lib.baomitu.com/typed.js/2.0.12/typed.min.js" ></script>
  <script>
    (function (window, document) {
      var typing = Fluid.plugins.typing;
      var subtitle = document.getElementById('subtitle');
      if (!subtitle || !typing) {
        return;
      }
      var text = subtitle.getAttribute('data-typed-text');
      
        typing(text);
      
    })(window, document);
  </script>







  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/tocbot/4.18.2/tocbot.min.js', function() {
    var toc = jQuery('#toc');
    if (toc.length === 0 || !window.tocbot) { return; }
    var boardCtn = jQuery('#board-ctn');
    var boardTop = boardCtn.offset().top;

    window.tocbot.init({
      tocSelector     : '#toc-body',
      contentSelector : '.markdown-body',
      headingSelector : CONFIG.toc.headingSelector || 'h1,h2,h3,h4,h5,h6',
      linkClass       : 'tocbot-link',
      activeLinkClass : 'tocbot-active-link',
      listClass       : 'tocbot-list',
      isCollapsedClass: 'tocbot-is-collapsed',
      collapsibleClass: 'tocbot-is-collapsible',
      collapseDepth   : CONFIG.toc.collapseDepth || 0,
      scrollSmooth    : true,
      headingsOffset  : -boardTop
    });
    if (toc.find('.toc-list-item').length > 0) {
      toc.css('visibility', 'visible');
    }
  });
</script>


  <script src=https://lib.baomitu.com/clipboard.js/2.0.10/clipboard.min.js></script>

  <script>Fluid.plugins.codeWidget();</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/anchor-js/4.3.1/anchor.min.js', function() {
    window.anchors.options = {
      placement: CONFIG.anchorjs.placement,
      visible  : CONFIG.anchorjs.visible
    };
    if (CONFIG.anchorjs.icon) {
      window.anchors.options.icon = CONFIG.anchorjs.icon;
    }
    var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
    var res = [];
    for (var item of el) {
      res.push('.markdown-body > ' + item.trim());
    }
    if (CONFIG.anchorjs.placement === 'left') {
      window.anchors.options.class = 'anchorjs-link-left';
    }
    window.anchors.add(res.join(', '));
  });
</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.js', function() {
    Fluid.plugins.fancyBox();
  });
</script>


  <script>Fluid.plugins.imageCaption();</script>

  <script  src="/js/local-search.js" ></script>




  
<script src="/static/js/customer.js"></script>
<script src="/static/js/md5.min.js"></script>
<script src="/static/js/gitalk.config.js"></script>



<!-- 主题的启动项，将它保持在最底部 -->
<!-- the boot of the theme, keep it at the bottom -->
<script  src="/js/boot.js" ></script>


  

  <noscript>
    <div class="noscript-warning">博客在允许 JavaScript 运行的环境下浏览效果更佳</div>
  </noscript>
</body>
</html>
